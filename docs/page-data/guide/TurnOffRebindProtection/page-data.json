{"componentChunkName":"component---src-templates-blog-post-js","path":"/guide/TurnOffRebindProtection/","result":{"data":{"site":{"siteMetadata":{"title":"山东大学镜像站"}},"markdownRemark":{"id":"334c07d3-086c-5862-8ce2-03b1063e2233","excerpt":"什么是 Rebind Protection，为什么要关闭它？ dnsmasq 提供了名为 rebind protection 的功能，意思是，当上游 DNS 返回了私有 IP 解析结果时，认为遭到了 DNS 劫持，从而拒绝此结果，以 NXDOMAIN 取代之。\n然而，山东大学的校园网已经将私有 IPv4 网段作为了校园网的一部分，   均被使用，以前两者尤甚。本镜像站所用服务器也使用了内网地址。因此，对应域名的 A 记录不可避免地要设置为私有 IP。\ndnsmasq 默认不开启 rebind protection 功能，但官方版本的 OpenWRT…","html":"<h2 id=\"什么是-rebind-protection，为什么要关闭它？\" style=\"position:relative;\"><a href=\"#%E4%BB%80%E4%B9%88%E6%98%AF-rebind-protection%EF%BC%8C%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E5%85%B3%E9%97%AD%E5%AE%83%EF%BC%9F\" aria-label=\"什么是 rebind protection，为什么要关闭它？ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>什么是 Rebind Protection，为什么要关闭它？</h2>\n<p>dnsmasq 提供了名为 rebind protection 的功能，意思是，当上游 DNS 返回了私有 IP 解析结果时，认为遭到了 DNS 劫持，从而拒绝此结果，以 NXDOMAIN 取代之。\n然而，山东大学的校园网已经将私有 IPv4 网段作为了校园网的一部分，<code class=\"language-text\">10.0.0.0/8</code> <code class=\"language-text\">172.16.0.0/12</code> <code class=\"language-text\">192.168.0.0/16</code> 均被使用，以前两者尤甚。本镜像站所用服务器也使用了内网地址。因此，对应域名的 A 记录不可避免地要设置为私有 IP。\ndnsmasq 默认不开启 rebind protection 功能，但官方版本的 OpenWRT 默认开启。如果你的路由器是基于 OpenWRT 的发行版，则需要手动关闭此功能。</p>\n<p>注意，我们仅推荐在山东大学校园网环境下关闭此功能。对于其他网络环境，应具体情况具体分析。</p>\n<h2 id=\"如何确定是否需要关闭此功能？\" style=\"position:relative;\"><a href=\"#%E5%A6%82%E4%BD%95%E7%A1%AE%E5%AE%9A%E6%98%AF%E5%90%A6%E9%9C%80%E8%A6%81%E5%85%B3%E9%97%AD%E6%AD%A4%E5%8A%9F%E8%83%BD%EF%BC%9F\" aria-label=\"如何确定是否需要关闭此功能？ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>如何确定是否需要关闭此功能？</h2>\n<ul>\n<li>在山东大学校园网环境下，如果出现浏览器不能访问 <code class=\"language-text\">mirrors.sdu.edu.cn</code> ，但可以访问 <code class=\"language-text\">10.102.32.195</code>（即前述域名对应的 A 记录）的情况，则表示当前 rebind protection 已经开启，需要关闭此功能。</li>\n<li>在山东大学校园网环境下，使用 <code class=\"language-text\">nslookup</code>、<code class=\"language-text\">dig</code> 等工具取得 <code class=\"language-text\">mirrors.sdu.edu.cn</code> 的 A 记录，结果为空，也表示当前 rebind protection 已经开启，需要关闭此功能。</li>\n</ul>\n<h2 id=\"如何关闭此功能？\" style=\"position:relative;\"><a href=\"#%E5%A6%82%E4%BD%95%E5%85%B3%E9%97%AD%E6%AD%A4%E5%8A%9F%E8%83%BD%EF%BC%9F\" aria-label=\"如何关闭此功能？ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>如何关闭此功能？</h2>\n<p>对于官方版本的 OpenWRT，可参考下图。即，选择 <code class=\"language-text\">网络</code> → <code class=\"language-text\">DHCP/DNS</code>  菜单，找到 <code class=\"language-text\">重绑定保护</code>，取消勾选这个选项。最后，别忘了点击 <code class=\"language-text\">保存&amp;应用</code> 按钮。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/docs/static/0fe441f6135cdd5849df5cbb6d801331/5a190/TurnOffRebindProtection-pic-1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 66.45569620253164%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAABJ0AAASdAHeZh94AAACAUlEQVQoz4WRvW/TQBiH/a8EGInVDMBUhjTlIyrFThoBgnSgS2YmVv4ChjKwMGWhZWZBaiPq5sOxIjfho1Vi5FBI09iO3Zx98Z2/DsW2yFARHr3S3Unvo/f96ahXHzsHbflb92en2//aO21L5/Xvg8bJkA9LlHVR1uvH543js3b/4qhviLLeOBntdZRPXxTqUT7PsuxGocAw7NNnRWbj8YP8kztrudUss5plMlkmc/9hVCv31lfurmfWmOLLUuHF5ut3b6mmIPB8UzwS32xv0zSdWqKvXb2SY5la9bDKcdzB51r1UGg25yU0W6LAt+o9qUsRQnzfJ4TUarUbN28xbC5J08+3tsj/sG2b8jzPcRxCSKVSWV6+nU6nk8nrpVIJQghM07IsCKFlhsfsFmMjNBwO55M5jqOTdCq1lEgkiptFVVU0TbNtG4XgEISQPWPqOG4sR0iStLOz+373Q7lc3t/fQxjb0ymybdd1nRCMsed5YW9ACIEQxnIwww8Icf34OQ2JB4VAaEUBIzDGc3mWCMKJBVHY/XfVKNRlEEJUpEYCRtiYAEPXLwwDmABacAKA67kLZUKw5yLHwZ6vW1Aba5quAwBM0xzrYwjhItkfKaBaB7xg8oLVEklPCn7IAULBwn+O5QBjV1UdVcWKdib/1gaD0ekvfTw2DGM0UhDC/5L/AK/ElNgfEIEkAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"TurnOffRebindProtection pic 1\"\n        title=\"TurnOffRebindProtection pic 1\"\n        src=\"/docs/static/0fe441f6135cdd5849df5cbb6d801331/f058b/TurnOffRebindProtection-pic-1.png\"\n        srcset=\"/docs/static/0fe441f6135cdd5849df5cbb6d801331/c26ae/TurnOffRebindProtection-pic-1.png 158w,\n/docs/static/0fe441f6135cdd5849df5cbb6d801331/6bdcf/TurnOffRebindProtection-pic-1.png 315w,\n/docs/static/0fe441f6135cdd5849df5cbb6d801331/f058b/TurnOffRebindProtection-pic-1.png 630w,\n/docs/static/0fe441f6135cdd5849df5cbb6d801331/5a190/TurnOffRebindProtection-pic-1.png 800w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>一般而言，到此就结束了。</p>\n<h2 id=\"提示\" style=\"position:relative;\"><a href=\"#%E6%8F%90%E7%A4%BA\" aria-label=\"提示 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>提示</h2>\n<p>如果路由器并未使用官方版本的 OpenWRT，也无法从设置界面中找到类似的设置，则可能无法从 Web 界面完成这个操作。此时，可以通过 SSH 连接到路由器，然后使用 <code class=\"language-text\">uci</code> 命令或者修改 <code class=\"language-text\">/etc/config/dhcp</code> 文件来达到目标。</p>\n<p>如果依然无法完成此操作，或者路由器并不基于 OpenWRT，但依然存在 rebind protection 问题，可将电脑端的 DNS 设置为非路由器 DNS 来直接绕过 rebind protection。注意，并非所有路由器都会允许底下的设备走第三方 DNS，有些路由器会通过 DNS 劫持的手段强制返回路由器 DNS 的结果。</p>\n<p>如果依然无法完成此操作，可考虑直接连接到山东大学校园网。</p>","tableOfContents":"<ul>\n<li><a href=\"#%E4%BB%80%E4%B9%88%E6%98%AF-rebind-protection%EF%BC%8C%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E5%85%B3%E9%97%AD%E5%AE%83%EF%BC%9F\">什么是 Rebind Protection，为什么要关闭它？</a></li>\n<li><a href=\"#%E5%A6%82%E4%BD%95%E7%A1%AE%E5%AE%9A%E6%98%AF%E5%90%A6%E9%9C%80%E8%A6%81%E5%85%B3%E9%97%AD%E6%AD%A4%E5%8A%9F%E8%83%BD%EF%BC%9F\">如何确定是否需要关闭此功能？</a></li>\n<li><a href=\"#%E5%A6%82%E4%BD%95%E5%85%B3%E9%97%AD%E6%AD%A4%E5%8A%9F%E8%83%BD%EF%BC%9F\">如何关闭此功能？</a></li>\n<li><a href=\"#%E6%8F%90%E7%A4%BA\">提示</a></li>\n</ul>","frontmatter":{"title":"校内用户必看：路由器关闭 Rebind Protection","date":"May 12, 2021","description":"","tags":["帮助文档"]}},"previous":{"fields":{"slug":"/guide/Debian/"},"frontmatter":{"title":"Debian 镜像源使用说明"}},"next":{"fields":{"slug":"/guide/Ubuntu/"},"frontmatter":{"title":"Ubuntu 镜像源使用说明"}}},"pageContext":{"id":"334c07d3-086c-5862-8ce2-03b1063e2233","previousPostId":"7fd1be2b-0dab-5e4e-a169-1f6030445378","nextPostId":"fe877bfd-e8ba-5126-a93c-2470e5662cdd"}},"staticQueryHashes":[]}